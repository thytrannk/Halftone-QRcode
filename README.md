# Halftone-QRcode

QR code [1] was invented in Japan to replace bar code because it has the capacity to encode more information. As the QR code
takes up space on the product packaging or advertisement, companies want to have ways to improve the aesthetics of the
code, such as embedding the company logo or product image into the code. There have been previous attempts at doing this;
however, most methods are tedious and require trial-and-error, and the results are only mediocre.

![Alt text](img/comparison.png?raw=true "Title")
QR codes generated by: (a) Unitag ([2]); (b) QArt ([3]); (c) Visualead [4] (Images taken from Chu et al. [5])

This is a simplified implementation of the algorithm by Chu et al. [5]. It divides each module of the QR code into 9
submodules (3 x 3) and keep the center module the same as the original QR code module, while the remaining modules match
the object halftone image.


## Requirements

* [FreeImage](http://freeimage.sourceforge.net)
* [Libqrencode](https://github.com/fukuchi/libqrencode)
* [ZXing](https://github.com/zxing/zxing)

## How the program works

The program takes as input an image (.jpg, .png, or .bmp). The image can be either colored or greyscale, but the program
will automatically convert it to greyscale. The user has an option of rescaling the image so that it fits the QR code
better. If the image is larger than the QR code, only the center part of the image would be embedded. If the image is
smaller than the QR code, the image will appear at the center of the QR code. The default QR code version is set to
version 6, which means the resulting halftone QR code would have a size of 123 × 123 pixels. The user then chooses the
halftone algorithm to use, either Floyd-Steinberg error diffusion [6] or dot diffusion [7] algorithm. After that, the
information that will be encoded in the QR code is input. If the amount of data exceeds the capacity of QR version 6,
the minimum version that is required would automatically be used. The program then outputs the halftone QR code.

### Example
Text encoded by the QR code: "This is a picture of Donald Duck."
Image embedded: a rescaled version of the image file donald_duck.jpg


    Object image file name: donald_duck.jpg
    X = 350; Y = 262; bpp = 32; nChannel = 4
    The QR code has size 123x123 pixels. Do you want to rescale the image to better fit the QR code? (y/n) y
    New width: 175
    New height: 131
    X = 175; Y = 131; bpp = 32; nChannel = 4
    Which halftoning algorithm do you want to use? (1: Floyd-Steinberg; 2: dot diffusion) 2
    What do you want to encode in the QR code? This is a picture of Donald Duck.
    Output filename (without extension): outputQR
    Decoded information from halftone QR: This is a picture of Donald Duck.
    
## Results

Below are some of the halftone QR code generated using this implementation. All of these QR codes could be decoded using
both ZXing library [8] (using .png images as input) and a QR code reader application on Android [9] (scanned under
normal room lighting).

![Alt text](img/results.png?raw=true "Title")

## References

[1] Denso Wave Incorporated. Qrcode.com. URL http://www.qrcode.com/en/.

[2] A. Laporte. UnitagQR. URL https://www.unitag.io/qrcode.

[3] R. Cox. Qart codes, Apr. 2012. URL https://research.swtch.com/qart.

[4] Visualead. Visualead. URL https://www.visualead.com.

[5] H.-K. Chu, C.-S. Chang, R.-R. Lee, and N. J. Mitra. Halftone qr codes. ACM Trans. Graph., 32(6):217:1−217:8, Nov. 2013.
ISSN 0730−0301. doi: 10.1145/2508363.2508408. URL http://doi.acm.org/10.1145/2508363.2508408.

[6] R.W. Floyd, L. Steinberg. An adaptive algorithm for spatial grey scale. Proceedings of the Society of Information
Display 17, 75–77, 1976.

[7] D. E. Knuth. Digital halftones by dot diffusion. ACM Trans. Graph., 6(4):245–273, Oct. 1987. ISSN 0730-0301.
doi: 10.1145/35039.35040. URL http://doi.acm.org/10.1145/ 35039.35040.

[8] S. Owen, D. Switkin, and Z. Team. Zxing, 2008. URL https://github.com/zxing/zxing.

[9] Sustainable App Developer. Qr code reader, 2018. URL https://play.google.com/store/apps/details?id=com.qrcodereaderapp.
